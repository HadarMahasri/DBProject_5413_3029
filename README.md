<div dir="rtl">

# פרויקט בסיסי נתונים
הדר מהסרי-213953029
הודיה גומה-329385413

יחידה נבחרת: operations branch
## תוכן עניינים
- מבוא
- תיאור המערכת
- תרשימי מערכת
- דיאגרמת יחסי ישויות-ERD 
- דיאגרמת סכמת נתונים-DSD
- החלטות עיצוב
- מבנה הטבלאות
- הכנסת נתונים
- שאילתות


 
 ### מבוא
מסמך זה מתאר את שלב א' בפרויקט מערכת ניהול מבצעים צבאית. המערכת מיועדת לניהול מידע על מבצעים צבאיים, יחידות המשתתפות בהם, המפקדים האחראים, הציוד הנדרש, המשימות הספציפיות והדוחות המבצעיים.

 ### תיאור המערכת
המערכת מיועדת לניהול ומעקב אחר מבצעים צבאיים על כל מרכיביהם. היא מאפשרת:

- תיעוד מבצעים צבאיים כולל מטרות, מיקומים ותאריכים
- ניהול יחידות צבאיות והשיוך שלהן לחילות השונים
- ניהול מפקדים, דרגותיהם וניסיונם
- מעקב אחר ציוד המשמש במבצעים
- ניהול משימות ספציפיות במסגרת כל מבצע
- תיעוד דוחות מבצעיים

המערכת מספקת את הפונקציונליות העיקרית הבאה:

הקצאת יחידות למבצעים
הקצאת ציוד למבצעים
תזמון משימות במסגרת מבצעים
מעקב אחר דוחות והתקדמות המבצעים
ניהול היררכיית הפיקוד והאחריות

 ### תרשימי מערכת
ERD - דיאגרמת יחסי ישויות
דיאגרמת ה-ERD מתארת את הישויות במערכת ואת היחסים ביניהן:
![alt text](image.png)
הישויות העיקריות במערכת:

מבצע (Operation) - הישות המרכזית המתארת מבצע צבאי
מפקד (Commander) - מפקדים האחראים על מבצעים
חיל (Corps) - החילות השונים בצבא
יחידה (Unit) - יחידות צבאיות המשתייכות לחילות
ציוד (Equipment) - ציוד צבאי המשמש במבצעים
משימה (Task) - משימות ספציפיות במסגרת מבצעים
דו"ח מבצעי (Operational Report) - דוחות על מבצעים

היחסים בין הישויות:

מוביל (Leads) - מפקד מוביל מבצע (יחס 1)
בוצע על ידי (Executed by) - מבצע מבוצע על ידי יחידות (יחס N)
מתזמן (Schedules) - מבצע כולל משימות (יחס 1)
דורש (Requires) - מבצע דורש ציוד (יחס N)
שייך ל (Belongs to) - יחידה שייכת לחיל (יחס N:1)
מתעד (Documents) - דוח מתעד מבצע (יחס N:1)

DSD - דיאגרמת סכמת נתונים
דיאגרמת ה-DSD מציגה את הטבלאות במסד הנתונים והקשרים ביניהן:
![alt text](image-1.png)
### החלטות עיצוב
במהלך תכנון המערכת התקבלו מספר החלטות עיצוב:

- שימוש במספרים רצים (SERIAL) - בחרנו להשתמש במספרים רצים עבור המפתחות הראשיים בכל הטבלאות כדי לפשט את תהליך ההוספה של נתונים חדשים ולמנוע שגיאות.
- הפרדה בין חיל ליחידה - החלטנו להפריד את החילות והיחידות לטבלאות נפרדות כדי לשקף את המבנה ההיררכי הצבאי ולאפשר שיוך של יחידות לחילות.
- ניהול קשרים רבים-לרבים (N) - עבור הקשרים בין מבצעים ליחידות ובין מבצעים לציוד, יצרנו טבלאות קשר מפורשות (Executed_by ו-Requires) כדי לנהל את הקשרים הרבים-לרבים.
- תיעוד זמנים של משימות - בחרנו לכלול שדות StartTime ו-EndTime בטבלת Task כדי לאפשר תזמון מדויק של משימות במסגרת המבצעים.

### מבנה הטבלאות 
להלן מבנה הטבלאות שיצרנו במסד הנתונים:

![alt text](image-2.png)
![alt text](image-3.png)
![alt text](image-4.png)\
![alt text](<שלב א/image-5.png>)


### הכנסת נתונים
שיטה 1 - Mockaroo
עבור טבלת commander:

![alt text](image-5.png)
![alt text](image-6.png)
עבור טבלת corps:
![alt text](image-7.png)
![alt text](image-8.png)

עבור טבלת operation:
![alt text](image-9.png)
![alt text](image-10.png)



שיטה 2- הכנסת נתונים מקבצי אקסל
עבור טבלת Equipment:






![alt text](image-11.png)





עבור טבלת OperationalReport:





![alt text](image-12.png)





עבור טבלת Unit:







![alt text](image-13.png)



שיטה 3- הכנסת נתונים דרך פייתון
עבור טבלת Executed_by:
![alt text](image-14.png)
![alt text](image-15.png)

עבור טבלת Task:
![alt text](image-16.png)
![alt text](image-17.png)

עבור טבלת Requires:
![alt text](image-18.png)
![alt text](image-19.png)


### גיבוי

ביצוע גיבוי: 

![alt text](image-20.png)

ביצוע שחזור:
יצרתי database חדש בשם backup על מנת לראות אם השחזור צלח.
ובהחלט 9 הטבלאות שוחזרו בהצלחה עם כל הנתונים. צירפתי דוגמא לטבלת unit בעלת 403 רשומות.

![alt text](image-21.png)

![alt text](image-22.png) 


## שאילתות

**1.השאילתה מציגה את כל המבצעים (Operations) שדורשים יותר ציוד מהממוצע הכללי של ציוד למבצע.
לכל מבצע מוצגים מזהה המבצע, שמו, וכמות הציודים הנדרשים לו, בסדר יורד לפי כמות הציוד.**

![צילום מסך 2025-05-05 174139](https://github.com/user-attachments/assets/d3e8e9e1-2124-403a-8052-8b66ac5fcf5e)


![WhatsApp Image 2025-05-05 at 13 45 18](https://github.com/user-attachments/assets/fbf8aa5f-064f-47e1-a98b-c3e06ac773f3)  

**2.השאילתה מחזירה את כל המפקדים שיש להם יותר מ־10 שנות ניסיון, אך אינם מובילים כרגע אף מבצע פעיל (כלומר, מבצע שטרם הסתיים).
הרשימה ממויינת לפי שנות הניסיון מהגבוה לנמוך.**

![צילום מסך 2025-05-05 181901](https://github.com/user-attachments/assets/f265a645-3352-450a-a62b-7da7faeee92f)

![צילום מסך 2025-05-05 182003](https://github.com/user-attachments/assets/20e6d990-9404-4083-b310-124f9bc462f0)

**3. השאילתה מחפשת מבצעים (Operations) שיש להם יותר משימות (Tasks) מהממוצע הכללי של משימות למבצע.
לכל מבצע מוצגים מזהה, שם, וכמות המשימות, כשהתוצאה ממויינת בסדר יורד לפי מספר המשימות.**

![צילום מסך 2025-05-05 174851](https://github.com/user-attachments/assets/92a7b383-bcd2-4768-81ce-c049c0507f0c)
  ![צילום מסך 2025-05-05 175343](https://github.com/user-attachments/assets/676d664e-b696-4ac0-ad34-47b30a3568e4)

  
  
**4.השאילתה מציגה את כל היחידות (Units) בצבא, יחד עם חיל השייכות שלהן והתמחות החיל,
ומחשבת עבור כל יחידה את מספר המבצעים (Operations) שבהם השתתפה – ממויין מהכי פעילה לפחות.**

![צילום מסך 2025-05-05 175725](https://github.com/user-attachments/assets/8b511604-a15f-454e-835a-a3215200a799)

![צילום מסך 2025-05-05 175905](https://github.com/user-attachments/assets/dc367970-382d-4ac5-b86d-2c0937a3a79f)  

**5.השאילתא בוחרת את מזהה הפעולה, שם הפעולה, תאריך התחלה ותאריך סיום של פעולות, ומחלקת את זמן הפעולה לפי ימים (DurationDays). 
היא מחזירה רק פעולות שמשך הזמן שלהן מעל 500 ימים וממיינת את התוצאות בסדר יורד לפי משך הזמן.**

![צילום מסך 2025-05-05 182329](https://github.com/user-attachments/assets/b3239a7f-2cf7-49ab-8199-9e95c2aa604d)
![צילום מסך 2025-05-05 182412](https://github.com/user-attachments/assets/c7af01eb-aed8-43b5-8078-5c665e9f3e70)

**6.השאילתא בוחרת את מזהה הציוד, שם הציוד, כמות הציוד הזמינה, מספר הפעמים שהציוד שומש בפעולות, וסך הכמות שנדרשה בכל הפעולות.
היא מציגה ציוד ששומש ביותר מפעם אחת, וממיינת את התוצאות בסדר יורד לפי מספר השימושים.**

![צילום מסך 2025-05-05 182744](https://github.com/user-attachments/assets/8d4266c4-e527-440a-86e3-6688ed9714c6)

![צילום מסך 2025-05-05 182832](https://github.com/user-attachments/assets/8da221f6-6828-46f3-a4bf-1a8b12843049)


**7.השאילתא מציגה משימות שבוצעו במהלך חודש פברואר 2023, כולל מזהה המשימה, תיאורה, תאריך, שעת התחלה, שעת סיום ושם הפעולה שאליה היא שייכת.
התוצאות ממוינות לפי תאריך המשימה ושעת ההתחלה.**

![צילום מסך 2025-05-05 182929](https://github.com/user-attachments/assets/ad5b2c12-cbe4-4c5f-98c2-1cf429981ef1)
![צילום מסך 2025-05-05 183132](https://github.com/user-attachments/assets/3b838630-dd04-4bb6-aaa0-0f49baffbaa0)

**8.השאילתא מציגה את מספר הפעולות שהחלו בכל חודש בשנת 2023. היא מחלקת את התוצאות לפי חודש ומציינת את מספר הפעולות שהחלו בכל אחד מהם, כשהמיון נעשה לפי מספר החודש בסדר עולה.**

![צילום מסך 2025-05-05 183305](https://github.com/user-attachments/assets/896f86fc-6436-433d-9211-ffb2c5a587c1)

![צילום מסך 2025-05-05 183452](https://github.com/user-attachments/assets/47cdfe5b-086b-44e7-93e1-d6db04d2371d)

  ### שאילתות עדכון

 **1.השאילתא מעדכנת את דרגת המפקדים בטבלה Commander, כך שכל מפקד שיש לו יותר מ־20 שנות ניסיון ואינו בדרגת "General", יקודם לדרגה זו.**

![צילום מסך 2025-05-05 192158](https://github.com/user-attachments/assets/a8d0c093-701c-446e-97ef-963253bc6bd6)

![צילום מסך 2025-05-05 192333](https://github.com/user-attachments/assets/fed086d7-956a-4da0-b52e-3953083f2c62)

![צילום מסך 2025-05-05 192431](https://github.com/user-attachments/assets/4ff7fe35-9690-424d-9211-d5275ed52575)

**2.השאילתה מעדכנת את עמודת תאריך הסיום (endDate) של פעולות שהסתיימו בפברואר 2023.
לכל פעולה כזו מתווספים 3 ימים לתאריך הסיום.**

![צילום מסך 2025-05-05 192710](https://github.com/user-attachments/assets/27ec85cd-a794-4390-925a-abbf06763bc3)
![צילום מסך 2025-05-05 192900](https://github.com/user-attachments/assets/13f79385-a582-4037-9944-4c5762de8073)
![צילום מסך 2025-05-05 192943](https://github.com/user-attachments/assets/3574efa2-ff51-4a03-ab9b-ed24ef9be354)

**3. השאילתה מעדכנת את עמודת Specialization לחיל האוויר בערך "Tactical Navigation".
העדכון יתבצע רק אם השדה ריק או לא הוזן בו ערך קודם (NULL או מחרוזת ריקה).**

![צילום מסך 2025-05-05 201110](https://github.com/user-attachments/assets/7ddc35a0-5d01-496e-b280-64dfa2e68f5f)
![צילום מסך 2025-05-05 202809](https://github.com/user-attachments/assets/bb381ccf-f478-4bc8-aaef-32738fae4f92)
![צילום מסך 2025-05-05 203247](https://github.com/user-attachments/assets/6c0715d3-5a23-4883-bebf-e4d2e9b6ce4e)

  ### שאילתות מחיקה
**1.השאילתה מוחקת את כל המשימות מהטבלה Task שתאריך הביצוע שלהן לפני 1 בינואר 2023.
המטרה היא לנקות נתונים ישנים שאינם רלוונטיים עוד.**


![צילום מסך 2025-05-05 205737](https://github.com/user-attachments/assets/7534b47e-9e46-412d-a548-1bb855988c1c)

![צילום מסך 2025-05-05 205912](https://github.com/user-attachments/assets/ed2ea27a-199f-460f-8982-40ae3d5821a6)

![צילום מסך 2025-05-05 210124](https://github.com/user-attachments/assets/75be394f-c0ed-4353-9ea8-97d64c5e2c92)

**2.השאילתה מוחקת ציוד מהטבלה Equipment שאינו נדרש לאף משימה לפי הטבלה Requires.
כלומר, היא מסירה ציוד שאין לו שימוש נוכחי במערכת.**

![צילום מסך 2025-05-05 210755](https://github.com/user-attachments/assets/3ff01838-8897-4fa6-b598-7893b6c78064)

![צילום מסך 2025-05-05 211416](https://github.com/user-attachments/assets/464de77f-785d-46ae-962e-e4b1b7733b8e)

![צילום מסך 2025-05-05 222504](https://github.com/user-attachments/assets/5713f95e-a527-42a9-99f6-d32e549f9b5c)

**3.השאילתה מוחקת רשומות מטבלת Requires שבהן מזהה הפעולה (OperationID) קיים גם בטבלת Operation, והפעולה הסתיימה לפני יותר מחודש.
היא משתמשת ב-USING כדי לבצע מחיקה מותנית על בסיס התאמה בין שתי טבלאות.**

![צילום מסך 2025-05-05 222737](https://github.com/user-attachments/assets/ab2ad606-1523-4719-8405-f5d07c02c5a4)

![צילום מסך 2025-05-05 222950](https://github.com/user-attachments/assets/be40a72e-1434-423a-8430-9ddbe5fbe766)
![צילום מסך 2025-05-05 223110](https://github.com/user-attachments/assets/dbd15eb2-bfd2-4e70-aeea-c1b67344f8cd)
## rollback ו-commit
**commit:**
![צילום מסך 2025-05-06 131720](https://github.com/user-attachments/assets/116b850a-aac5-4d65-a624-ac66b5005db1)

![צילום מסך 2025-05-06 132334](https://github.com/user-attachments/assets/157db283-04cf-4eb7-b4cb-355fb7cd9713)
![צילום מסך 2025-05-06 132718](https://github.com/user-attachments/assets/72c70751-3aaf-4d1f-a4db-b98316e7218c)
**rollback:**
![צילום מסך 2025-05-06 132856](https://github.com/user-attachments/assets/cf152637-e642-443f-a989-c6531dd40b55)
![צילום מסך 2025-05-06 133037](https://github.com/user-attachments/assets/f21af9cb-fbd1-49be-b47e-d79b265a986a)

![צילום מסך 2025-05-06 133154](https://github.com/user-attachments/assets/ca181463-dab0-4109-961a-44721d84739a)

## אילוצים

###   Check אילוצי 

![alt text](check1.png)


![alt text](check2.png)


###   Not NULL אילוצי 

![alt text](<not null.png>)

###   Deafult אילוצי 

![alt text](deafult1.png)

# שלב ג

-DSD של האגף החדש:

![alt text](image-35.png)

-ERD של האגף החדש:

 ![alt text](image-34.png)

-ERD של האינטגרציה: 

![alt text](intergration-2.png)

-DSD של האינטגרציה:

 ![alt text](integrationDSD.png)
 

## דוח שלב האינטגרציה - מערכת מידע רפואי וצבאית
  ### *החלטות שנעשו בשלב האינטגרציה*
**1. החלטה על מבנה הירושה**
החלטה: יצירת טבלת Soldier כטבלת אב משותפת לישויות Commander, Paramedic ו-Patient.
נימוק:

כל שלושת הסוגים הם בעצם חיילים עם תפקידים שונים
מאפשר ניהול מאוחד של מידע בסיסי (שם, מזהה)
יוצר היררכיה לוגית המשקפת את המציאות הצבאית


**2.  החלטה על טווחי מזהים נפרדים**

מפקדים: 1,000,000 + מזהה מקורי (טווח: 1,000,001 - 1,999,999)
פרמדיקים: 2,000,000 + מזהה מקורי (טווח: 2,000,001 - 2,999,999)
מטופלים: 3,000,000 + מזהה מקורי (טווח: 3,000,001 - 3,999,999)

נימוק:

מניעת התנגשויות בין מזהים מטבלאות שונות
זיהוי מיידי של סוג החייל לפי טווח המזהה
שמירה על פשטות המבנה ללא עמודות נוספות


**3. החלטה על שמות עמודות**
החלטה: שמירה על השמות המקוריים של העמודות (commander_id, paramedic_id, patient_id).
נימוק:

שמירה על תאימות עם קוד ומערכות קיימות
הבנה אינטואיטיבית של התפקיד לפי שם העמודה
הימנעות משינויים נרחבים בטבלאות הקשר

**4. החלטה על מיזוג טבלאות ציוד**
החלטה: שימוש במפתח מורכב (EquipmentID, equipment_type) במקום שינוי מזהים.
נימוק:

שמירה על המזהים המקוריים של הציוד
גמישות להוספת סוגי ציוד נוספים בעתיד
טבלה אחת לכל סוגי הציוד האפשריים (צבאי ורפואי)

**5. החלטה על קישור אירועים רפואיים למבצעים**
החלטה: קישור לפי תאריכים - אירוע רפואי שהתרחש בין תאריך התחלה וסיום של מבצע מקושר אליו.
נימוק:

קישור הגיוני המבוסס על זמן התרחשות
במבצע יכולים להתרחש מספר אירועים רפואיים



### הסבר מילולי של התהליך והפקודות

#### שלב 1: הכנה ליצירת הירושה

![alt text](image-23.png)



**הסבר: יצירת טבלת האב 
Soldier עם מבנה מינימלי - רק מזהה ושם. טבלה זו תשמש בסיס לכל סוגי החיילים.**

#### שלב 2: עדכון טבלת המפקדים

![alt text](image-24.png)

**הסבר: לפני שינוי מבנה הטבלה, חובה להסיר את כל האילוצים התלויים בה. קודם מסירים מפתחות זרים מטבלאות אחרות שמצביעות לטבלה, ואז את המפתח הראשי של הטבלה עצמה.**

![alt text](image-26.png)

**הסבר: הוספת המפקדים לטבלת האב עם המזהים החדשים (מקורי + מיליון), ואז עדכון המזהים בטבלת המפקדים עצמה להתאמה.**

![alt text](image-27.png)

**הסבר: עדכון כל הטבלאות שמפנות למפקדים כדי להתאים למזהים החדשים, ויצירת המפתחות מחדש לאחר השינויים.**



#### שלב 3: עדכון טבלת הפרמדיקים
התהליך זהה לשלב המפקדים, אך עם הוספת 2,000,000 למזהים:
![alt text](image-28.png)

#### שלב 4: עדכון טבלת המטופלים

![alt text](image-29.png)

#### שלב 5: מיזוג טבלאות ציוד

![alt text](image-30.png)

**הסבר: במקום לשנות מזהים, אנחנו יוצרים מפתח מורכב שמורכב ממזהה הציוד וסוגו. זה מאפשר לאותו מזהה להתקיים פעמיים - פעם אחת כציוד צבאי ופעם כציוד רפואי.**

**הסבר: העתקת הציוד הרפואי לטבלת הציוד המאוחדת עם שמירה על המזהים המקוריים וסימון הסוג כ-'Medical'.**

#### שלב 6: עדכון טבלאות הקשר לציוד

![alt text](image-31.png)

**הסבר: הוספת עמודת סוג ציוד לטבלאות הקשר ועדכון הערכים בהתאם. ציוד שמופיע בטבלת הציוד הרפואי מסומן כ-'Medical'.**

**הסבר: יצירת מפתח זר מורכב שמתאים למפתח הראשי המורכב של טבלת הציוד.**


#### שלב 7: קישור אירועים רפואיים למבצעים

![alt text](image-32.png)

**הסבר: הוספת עמודה לקישור אירועים רפואיים למבצעים, ועדכון אוטומטי של הקישורים לפי תאריכים. אירוע שהתרחש בזמן מבצע מקושר אליו.**


### מבטים-Views

### View1
🏥 מבט 1: האגף הרפואי - Active_Paramedics
תכלית המבט
מבט המיועד לניהול הצוות הרפואי ומתמקד בביצועי הפרמדיקים והטיפולים שהם מעניקים.

טבלאות מעורבות:

<div dir="rtl">

Paramedic -
 מידע על הפרמדיקים (מזהה, שם, ניסיון)


Treatment - 
מידע על הטיפולים שניתנו (משך, סוג, תאריך)
</div>

![alt text](image-39.png)

![alt text](image-36.png)

שאילתא-1
-- שאילתה 1: מיהם הפרמדיקים הכי פעילים?
-- שאלה מעשית: איזה פרמדיקים נותנים הכי הרבה טיפולים?


![alt text](image-40.png)

![alt text](image-41.png)


שאילתא-2
-- שאילתה 2: איזה פרמדיקים צריכים עזרה או הכשרה?
-- שאלה מעשית: מי הפרמדיקים החדשים או הפחות פעילים שצריכים תמיכה?

![alt text](image-42.png)

![alt text](image-43.png)


### View2

 מבט 2: האגף הצבאי - Units_In_Operations
תכלית המבט
מבט המיועד לניהול הכוחות והמבצעים ומתמקד בהשתתפות יחידות במבצעים שונים.
טבלאות מעורבות:

Operation -
 מידע על המבצעים (שם, מיקום, תאריכים)

Executed_by -
טבלת קשר בין מבצעים ליחידות

Unit - 
מידע על היחידות (שם, כמות חיילים)

Corps -
 מידע על החילות (שם, התמחות)

![alt text](image-45.png)

![alt text](image-44.png)

שאילתא-1

-- שאילתה 1: איזה יחידות הכי פעילות?
-- שאלה פשוטה: אילו יחידות השתתפו בהכי הרבה מבצעים?

![alt text](image-46.png)

![alt text](image-47.png)

שאילתא-2

-- שאילתה 2: איזה חילות הכי נדרשים?
-- שאלה פשוטה: איזה סוגי חילות הכי הרבה פעמים נקראים למבצעים?

![alt text](image-49.png)

![alt text](image-48.png)


</div>
